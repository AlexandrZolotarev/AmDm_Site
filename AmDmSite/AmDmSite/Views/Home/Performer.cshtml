@using AmDmSite.Models.SiteDataBase
@model PagedList.IPagedList<AmDmSite.Models.SiteDataBase.Song>
@using PagedList.Mvc;

<style>
    #name {
        width: 85%;
    }

    #views {
        width: 15%;
        text-align: center;
    }
</style>
<div style="position: absolute; left: 50%;">
  <span id="notification" style="color:red;font-size:15px; position: relative; left: -50%;"></span>
</div>  
      
<h1>@ViewBag.PerformerName</h1>
@if (ViewBag.PerformerBiography != "")
{
<h3> Биография </h3>
}
<br />
@ViewBag.PerformerBiography
<br />
<div class="h1__info">Список композиций</div>
<table class="items">
    <thead><tr class="top_label">
        <th colspan="2">
        Композиция
        @(Html.ActionLink("A-z", "Index", "Home", new { ViewBag.Page, column = 1, typeAscending = ViewBag.NameType }, null))
        </th>
        <th class="number">
        Просмотров
            @(Html.ActionLink("⇅", "Index", "Home", new { ViewBag.Page, column = 2, typeAscending = ViewBag.SongsType }, null))
        </th>
        </tr>
    </thead>

    <tbody>
        @foreach (var song in Model)
        {
            <tr>
                <td class="artist_name" id="name">
                    @(Html.ActionLink(song.Name, "Song", "Home", new { performerId = song.PerformerId, songNumber = song.Number }, null))
                </td>
                <td class="number" id="views">@song.ViewsCount</td>
            </tr>
        }
    </tbody>
</table>

@Html.PagedListPager(Model, page => Url.Action("Performer", new { ViewBag.PerformerId, page }))
@section scripts{
    <script src="~/Scripts/jquery.signalR-2.2.2.min.js"></script>
    <!--Ссылка на автоматически сгенерированный скрипт хаба SignalR -->
    <script src="~/signalr/hubs"></script>
    <script src="~/signalr/hubs"></script>
    <script type="text/javascript">

       $(function () {
           var notificationhub = $.connection.notificationHub;
           notificationhub.client.displayMessage = function (message) {
               $('#notification').html("<div class=\"alert alert-info alert-dismissable\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\" aria-label=\"close\">×</a><strong>Update! </strong>"+message+"</div>");
           };
           $.connection.hub.start();

       });
    </script>
}   